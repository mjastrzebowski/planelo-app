<ion-navbar *navbar>
  <button menuToggle>
    <ion-icon name="menu"></ion-icon>
  </button>

  <ion-segment *ngIf="auth.isOwner" [(ngModel)]="segment" (change)="segmentChange()">
    <ion-segment-button value="list">
      Lista
    </ion-segment-button>
    <ion-segment-button value="calendar">
      Kalendarz
    </ion-segment-button>
  </ion-segment>

  <ion-title *ngIf="auth.isTrainer || auth.isClient">Treningi</ion-title>

  <ion-buttons end>
    <button [hidden]="auth.isTrainer" (click)="showTrainingForm()">
      <ion-icon name="add"></ion-icon>
    </button>
  </ion-buttons>
</ion-navbar>

<ion-content class="trainings">
  <!-- <ion-searchbar primary
                 [(ngModel)]="queryText"
                 (input)="updateClients()"
                 placeholder="Szukaj">
  </ion-searchbar> -->
  <ion-list *ngIf="!loaded">
    <ion-list-header>
      <ion-row center>
        <ion-col width-20>
          <ion-spinner name="dots" class="spinner-dots"><svg viewBox="0 0 64 64" style="left: 9px; animation-delay: 0ms; animation-duration: 750ms;"><circle transform="translate(32,32)" r="6"></circle></svg><svg viewBox="0 0 64 64" style="left: 0px; animation-delay: -110ms; animation-duration: 750ms;"><circle transform="translate(32,32)" r="6"></circle></svg><svg viewBox="0 0 64 64" style="left: -9px; animation-delay: -220ms; animation-duration: 750ms;"><circle transform="translate(32,32)" r="6"></circle></svg></ion-spinner>
        </ion-col>
        <ion-col>Ładowanie treningów...</ion-col>
      </ion-row>
    </ion-list-header>
  </ion-list>

  <div id="calendar" [hidden]="(auth.isClient || auth.isOwner) && segment !== 'calendar'"></div>

  <div [hidden]="!loaded || segment !== 'list'">
    <ion-list *ngIf="auth.isOwner">
      <ion-item-sliding *ngFor="#workout of workouts | async; #w = index" #slidingItem [attr.track]="workout.key">
        <button ion-item (click)="showTrainingForm(workout)">
          <h3><strong>{{workout.timeStart}} - {{workout.timeEnd}}</strong>, {{workout.descDate}}</h3>
          <p>{{workout.place}}, <strong>{{workout.client}}</strong>, {{workout.trainer}}</p>
        </button>
      </ion-item-sliding>
    </ion-list>

    <ion-list *ngIf="auth.isClient">
      <ion-item-sliding *ngFor="#workout of workouts | async; #w = index" #slidingItem [attr.track]="workout.key" [hidden]="workout.completed">
        <ion-item>
          <h3><strong>{{workout.timeStart}} - {{workout.timeEnd}}</strong>, {{workout.descDate}}</h3>
          <p>{{workout.place}}, <strong>{{workout.trainer}}</strong></p>
          <button favorite item-right *ngIf="workout.fullDate > changeDate" (click)="deleteTraining(workout)">Odwołaj</button>
          <button danger item-right *ngIf="workout.fullDate < changeDate && workout.fullDate > currentDate" (click)="deleteTrainingLate(workout)">Odwołaj</button>
        </ion-item>
      </ion-item-sliding>
    </ion-list>

    <ion-buttons padding *ngIf="auth.isClient">
      <button primary block type="submit" (click)="showTrainingForm()">Dodaj trening</button>
    </ion-buttons>
  </div>
</ion-content>
